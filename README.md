# genetic-
# Genetic algoritm 을 이용한 회귀식 찾기

코딩으로 유전 알고리즘을 구현하는데에는 한계가 있어가지고  코드 구현을 빼고 직접 푸는 과정을 나타내도록 하겠습니다.

---

우선 저는 영화중에 나우유씨미2라는 영화가 있는데요 x축을 개봉날짜로 y축을 관객수로 생각해서 하기로 했습니다 (출처는 맨 밑에 두기로 하겠습니다) 표본은 6개로 하겠습니다

7월 12일 개봉1일차: 관객수 104,579명

7월 13일 개봉2일차: 관객수 196,289명

7월 14일 개봉3일차: 관객수 158,098명

7월 15일 개봉4일차: 관객수 197,373명

7월 16일 개봉5일차:관객수 462,530명

7월 17일 개봉6일차:관객수:419,418명

이걸 엑셀 그래프로 표현하면 이런 형태가 나옵니다.

![image](https://user-images.githubusercontent.com/62733873/85681642-73e07c80-b706-11ea-8746-bbf41515b127.png)

여기서 우선 내가 알고 있는 집합은 이렇다



내가 알고있는 집합 1  x=1일때 104,579

내가 알고있는 집합  2  x=2일때 196,289

내가 알고있는 집합  3  x=3일때 158,098

내가 알고있는 집합  4 x=4일때 197,373

내가 알고있는 집합  5 x=5일때  462,530

내가 알고있는 집합  6 x=6일때  419,418



그리고 여기서 회귀식을 찾는 거기 때문에 나는 함수를 이렇게 정의할 것이다

f(x)=a+bx+cx^2+dx^3 이라고 둘것이다

---

위의 f(x)식에서 후보해를 고르기 위한 값으로 0  <=x <=  31 구간을 잡을 것이다.

그리고 랜덤으로 후보해를 고를건데 (이건 c언어에 srand함수를 사용했습니다.)

이걸 표로 작성하면 아래처럼 형성이 됩니다.

|         | a    | b    | c    | d    |
| ------- | ---- | ---- | ---- | ---- |
| 후보해1 | 17   | 8    | 22   | 17   |
| 후보해2 | 30   | 14   | 5    | 1    |
| 후보해3 | 0    | 20   | 21   | 22   |
| 후보해4 | 12   | 6    | 8    | 24   |

후보해 1은 17+8x+22x^2+17^3 이니 x=1일때 적합도는 64

후보해 2은 30+14x+5x^2+x^3 이니 x=2일때 적합도는 76

후보해 3은 20x+21x^2+22x^3 이니 x=3일때 적합도는 843

후보해 4은 12+6x+8x^2+24x^3 이니 x=4일때 적합도는 1700

이렇게 나온다 이제 이걸 이용해 원반면적이랑 ,적합도, 계랑 평균까지 한거를 표에 추가 시키면

|         | a    | b    | c    | d    | 적합도 | 원반 면적 |
| ------- | ---- | ---- | ---- | ---- | ------ | --------- |
| 후보해1 | 17   | 8    | 22   | 17   | 64     | 2         |
| 후보해2 | 30   | 14   | 5    | 1    | 76     | 3         |
| 후보해3 | 0    | 20   | 21   | 22   | 843    | 31        |
| 후보해4 | 12   | 6    | 8    | 24   | 1700   | 64        |
| 계      |      |      |      |      | 2683   | 100       |
| 평균    |      |      |      |      | 670.75 |           |

2진표현은 선택 연산에서 진행 할 것입니다.



이 그래프로 선택연산에서 할 원반면적을 보이고 있고 평균은 670.75 를 나타내고 있습니다

이젠 밑에서 선택연산을 진행할 것 입니다.

---

우선 선택연산을 하기 위한 후보해들의 2진표현을 정리할 것입니다.

|         | 2진표현                 |
| ------- | ----------------------- |
| 후보해1 | 10001 01000 10110 10001 |
| 후보해2 | 11110 01110 00101 00001 |
| 후보해3 | 00000 10100 10101 10110 |
| 후보해4 | 01100 00110 01000 11000 |

여기서 이제 아까 구한 후보해의 원반 면적을 이용해 roulette wheel 방법으로 표현을 하면 아래와 같이 표현될 수 있다.

![roulette wheel 1](https://user-images.githubusercontent.com/62733873/85681495-4d224600-b706-11ea-9801-f41e73f4d1b6.PNG)

후보해 1의 적합도 :64 

후보해 2의 적합도 :76

후보해 3의 적합도 :843

후보해 4의 적합도: 1700

(후보해의 해당되는 원반 면적은 후보해의 적합도/모든 후보해의 적합도)



룰렛 휠 방법을 사용해서 여기서는 후보해  3과 2는 한번만 선택되었다고 가정하고

후보해 4는 두번선택되었다고 가정을 할 것이다.

이렇게까지하면 선택 연산은 끝입니다.

---

여기서는 이제 교차 연산을 진행할 것인데 앞에서 설명한 후보해 3,2 는 한번씩 후보해 4는 두번이니 

| 위 후보해 2 아래 후보해4             | 여기는 바꾼표현                      |
| ------------------------------------ | ------------------------------------ |
| **11110 01110 00101 00001**       -> | **11110 00110 0**1000 11000      (1) |
| 01100 00110 01000 11000      ->      | 01100 01110 0**0101 00001**      (2) |



| 위 후보해 3 아래 후보해 4        | 여기는 바꾼 표현                  |
| -------------------------------- | --------------------------------- |
| **00000 10100 10101 10110**   -> | **00000 00110 0**1000 11000   (3) |
| 01100 00110 01000 11000   ->     | 01100 10100 1**0101 10110**  (4)  |

이러면 이제 (1),(2),(3),(4) 라는 새로운 후보해(즉 두번째 후보해)를 만들 수 있다.

---

여기서는 이제 돌연변이 연산을 진행 할 것이다.

교차 연산을 한 후보해중에 무작위로 (3)이 선택되었다고 가정할 것이다.

돌연변이 율은 일반적으로는 (1/PopSize)~(1/Length) 의 범위에서 사용된다고 해가지고

저의 후보해 개수는 4개기때문에 1/4 ~ 1/20 사이에서 주로 사용된다하니 그 사이의 값인 0.07을 사용했습니다.

| 후보해 3 (교차 연산한)      | 바뀐 값                     |
| --------------------------- | --------------------------- |
| 000**0**0 00110 01000 11000 | 000**1**0 00110 01000 11000 |



---

이렇게 까지하면 첫번째 후보해가 끝나고 두번째 후보해의 적합도를 계산해 볼 것이다.

후보해의 2진 표현은 이렇게 나오고

|         | 2진 표현                |
| ------- | ----------------------- |
| 후보해1 | 11110 00110 01000 11000 |
| 후보해2 | 01100 01110 00101 00001 |
| 후보해3 | 00010 00110 01000 11000 |
| 후보해4 | 01100 10100 10101 10110 |



|         | a    | b    | c    | d    | 적합도 |
| ------- | ---- | ---- | ---- | ---- | ------ |
| 후보해1 | 30   | 6    | 8    | 24   | 68     |
| 후보해2 | 12   | 14   | 5    | 1    | 68     |
| 후보해3 | 2    | 6    | 8    | 24   | 740    |
| 후보해4 | 12   | 20   | 21   | 22   | 1836   |

| 계                                                                                                                                2712 |
| ------------------------------------------------------------ |
| 평균                                                                                                                             678 |

평균 적합도가 670.75 에서 678 까지 조금 향상된 것을 볼 수 있지만 일반적으로는 더 우수한 해를 얻기 위해서는 계속 계속 돌려야 되기때문에 더 이상 향상되지 않으면 이러한 반복은 멈출 것입니다.(즉 알고리즘을 계속 돌리다 가장 적합도가 높은 것으로 리턴시킬 것이다.)

---

적합도가 더 나아지는지를 확인하기 위해 한번더 실행을 해 볼 것이다.

앞서 한번 실행한 결과의 후보해이다 

|         | a    | b    | c    | d    |
| ------- | ---- | ---- | ---- | ---- |
| 후보해1 | 30   | 6    | 8    | 24   |
| 후보해2 | 12   | 14   | 5    | 1    |
| 후보해3 | 2    | 6    | 8    | 24   |
| 후보해4 | 12   | 20   | 21   | 22   |

후보해 1은 30+6x+8x^2+24x^3 이니 x=1일때 적합도는 68

후보해 2은 12+14x+5x^2+1x^3이니 x=2일때 적합도는 68

후보해 3은 2+6x+8x^2+24x^3 이니 x=3일때 적합도는 740

후보해 4은 12+20x+21x^2+22x^3 이니 x=4일때 적합도는 1836

이렇게 나오고 앞에서 한것처럼 표로 한번 더 정리를 해볼것이다.



|         | a    | b    | c    | d    | 적합도 | 원반면적 |
| ------- | ---- | ---- | ---- | ---- | ------ | -------- |
| 후보해1 | 30   | 6    | 8    | 24   | 68     | 3        |
| 후보해2 | 12   | 14   | 5    | 1    | 68     | 3        |
| 후보해3 | 2    | 6    | 8    | 24   | 740    | 27       |
| 후보해4 | 12   | 20   | 21   | 22   | 1836   | 67       |

| 계                                                                                             2712                      100 |      |
| ------------------------------------------------------------ | ---- |
| 평균                                                                                         678 |      |

 이제 여기서 선택연산을 진행할 것입니다

선택 연산을 하기 위한 후보해들의 2진표현은



|         | 2진표현                 |
| ------- | ----------------------- |
| 후보해1 | 11110 00110 01000 11000 |
| 후보해2 | 01100 01110 00101 00001 |
| 후보해3 | 00010 00110 01000 11000 |
| 후보해4 | 01100 10100 10101 10110 |

여기서 아까 구한 후보해의 원반 면적을 이용해 roulette wheel 방법을 이용하여 표현을 하면



![image-20200625151740730](C:\Users\장석빈\AppData\Roaming\Typora\typora-user-images\image-20200625151740730.png)

후보해 1의 적합도: 68

후보해 2의 적합도:68

후보해 3의 적합도:740

후보해 4의 적합도:1836

(후보해의 해당되는 원반 면적은 후보해의 적합도/ 모든 후보해의 적합ㄷ호)



룰렛 휠 방법을 사용해서 여기서도 후보해 3과 후보해 2는 한번만 선택되었다고 가정하고 후보해 4는 두번선택되었다고 가정을 할 것이다.

이렇게 까지하면 선택 연산은 끝이다.



여기서는 이제 교차 연산을 진행할 것이고 앞에서 설명한 후보해 3,2 한번씩 후보해 4는 두번씩이니

| 위 후보해 2 아래 후보해 4             | 여기가 바꾼 표현                  |
| ------------------------------------- | --------------------------------- |
| **01100 01110 00101 00001**        -> | **01100 10100 1**0101 10110   (1) |
| 01100 10100 10101 10110        ->     | 01100 01110 0**0101 00001**   (2) |



| 위 후보해 3 아래 후보해 4        | 여기가 바꾼 표현                   |
| -------------------------------- | ---------------------------------- |
| **00010 00110 01000 11000**   -> | **00010 10100 1**0101 10110   (3 ) |
| 01100 10100 10101 10110   ->     | 01100 00110 0**1000 11000**   (4)  |

여기서 이제 (1),(2),(3),(4) 라는 새로운 후보해를 만들어냈다.



여기서는 이제 돌연변이 연산을 진행할것이다.

앞에서했던거랑 똑같이 후보해중에 무작위로 (3)이 선택되었다고 가정하고 돌연변이 율은

위에서 했던거랑 똑같이 (1/Popsize)~(1/Length)의 범위에서 사용

즉 1/4 ~ 1/20 사이에서 주로 사용하니 0.07

| 후보해3(교차 연산한)        | 바뀐 값                     |
| --------------------------- | --------------------------- |
| 000**1**0 10100 10101 10110 | 000**0**0 10100 10101 10110 |

이렇게까지하면 후보해가 끝나고 다음 적합도를 계산해볼것이다 후보해의 2진 표현은 이렇게 나오고



|         | 2진표현                 |
| ------- | ----------------------- |
| 후보해1 | 01100 10100 10101 10110 |
| 후보해2 | 01100 01110 00101 00001 |
| 후보해3 | 00000 10100 10101 10110 |
| 후보해4 | 01100 00110 00101 00001 |



|         | a    | b    | c    | d    | 적합도 |
| ------- | ---- | ---- | ---- | ---- | ------ |
| 후보해1 | 12   | 20   | 21   | 22   | 77     |
| 후보해2 | 12   | 14   | 5    | 1    | 68     |
| 후보해3 | 0    | 20   | 21   | 22   | 843    |
| 후보해4 | 12   | 6    | 5    | 1    | 180    |

| 계   | 1168 |
| ---- | ---- |
| 평균 | 292  |

평균 적합도가 원래 했던것보다 상당히 줄어든 것을 볼 수 있다 이것은 코딩에서는 버려지는 값일 것이다 (여러번 돌리면서 최적의 해를 찾는 알고리즘이기 때문)

이 후보해는 버려질 것이고 계속 계속 돌려서 최적의 해가 나오면 이 알고리즘은 종료될것입니다.

---



출처:[:[링크](https://blog.naver.com/uchan2004/220760972700) //관객수랑 개봉날짜
